<div class="container py-4">
    <div class="card shadow bg-dark text-light border-warning">
        <div class="card-body">
            <div class="text-center my-4">
                <h3 class="mt-2 text-warning">ğŸ“¦ ØªØ³Ø¬ÙŠÙ„ Ù…ÙÙ‚ÙˆØ¯Ø§Øª</h3>
            </div>

            <div class="text-end my-3" dir="rtl">
                <button class="btn btn-outline-info" routerLink="/show-lostItems">Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„</button>
            </div>

            <form (ngSubmit)="submitForm()" dir="rtl">
                <!-- Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙŠÙˆÙ… -->
                <div class="row g-3 mb-3">
                    <div class="col-md-6">
                        <label class="form-label fw-bold">ØªØ§Ø±ÙŠØ®</label>
                        <input type="date" [(ngModel)]="formData.date" name="date"
                            class="form-control bg-dark text-light border-warning" (change)="onDateChange()" />
                    </div>

                    <div class="col-md-6">
                        <label class="form-label fw-bold">Ø§Ù„ÙŠÙˆÙ…</label>
                        <input type="text" [(ngModel)]="formData.day" name="day"
                            class="form-control bg-dark text-light border-secondary" readonly />
                    </div>
                </div>

                <!-- Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø­Ù‚ÙˆÙ„ -->
                <div class="row g-3 my-2" *ngFor="let field of fields; let i = index">
                    <div class="col-md-8" *ngIf="field.key !== 'date' && field.key !== 'day'">
                        <div class="input-group gap-2">
                            <input [(ngModel)]="formData[field.key]" name="{{ field.key }}"
                                [type]="field.type || 'text'" class="form-control bg-dark text-light border-light"
                                placeholder="{{field.label}}" #fieldInput />

                            <!-- âœ… Suggestion Box Ù„Ø­Ù‚Ù„ Ù…Ø³Ø¦ÙˆÙ„ Ø§Ù„Ø£Ù…Ù† -->
                            <ul *ngIf="field.key === 'SecurityOfficer' && formData.SecurityOfficer && getFilteredOfficers().length"
                                class="suggestions mt-1">
                                <li *ngFor="let officer of getFilteredOfficers()"
                                    (click)="formData.SecurityOfficer = officer">
                                    {{ officer }}
                                </li>
                            </ul>

                            <!-- Ø²Ø± Ø§Ù„Ù…Ø§ÙŠÙƒ -->
                            <button type="button" class="btn btn-sm rounded-circle"
                                [ngClass]="{ 'btn-outline-warning': !(isRecognizing && activeField === field.key), 'btn-warning pulse': isRecognizing && activeField === field.key }"
                                (mousedown)="startRecognition(field.key)" (mouseup)="stopRecognition()"
                                (mouseleave)="stopRecognition()" title="Ø§Ø¶ØºØ· Ù„Ù„ØªØ³Ø¬ÙŠÙ„">
                                {{ isRecognizing && activeField === field.key ? 'ğŸ™ï¸' : 'ğŸ¤' }}
                            </button>

                            <!-- Ø²Ø± Ø§Ù„Ù…Ø³Ø­ -->
                            <button type="button" class="btn btn-sm btn-outline-danger" (click)="clearField(field.key)"
                                title="Ù…Ø³Ø­">
                                ğŸ—‘ï¸
                            </button>
                        </div>
                    </div>
                </div>

                <div class="text-center mt-4 fixed-bottom mb-3">
                    <button type="submit" class="btn btn-lg fw-bold px-5" [disabled]="!isFormValid() || isSubmitting"
                        style="background-color: #FFD700; color: black;">
                        {{ isSubmitting ? 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„...' : 'âœ… Ø¥Ø¯Ø®Ø§Ù„' }}
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>


<!-- Animation Style -->
<style>
    .pulse {
        animation: pulse-animation 1s infinite;
    }

    @keyframes pulse-animation {
        0% {
            box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.7);
        }

        70% {
            box-shadow: 0 0 0 10px rgba(255, 215, 0, 0);
        }

        100% {
            box-shadow: 0 0 0 0 rgba(255, 215, 0, 0);
        }
    }
</style>