<div class="table-responsive mt-4">
    <div class="text-end mb-3">
        <button class="btn btn-outline-warning" (click)="getInjuries()">๐ ุชุญุฏูุซ ุงูุจูุงูุงุช</button>
    </div>

    <table class="table table-bordered table-hover text-center align-middle custom-table mb-5">
        <thead class="table-warning text-dark">
            <tr>
                <th>#</th>
                <th>ุงูุชุงุฑูุฎ</th>
                <th>ุงูููู</th>
                <th>ุงูุชูููุช</th>
                <th>ุงูููุงู</th>
                <th>ุงุณู ุงูุนุถู</th>
                <th>ุฑูู ุงูุนุถููุฉ</th>
                <th>ููุน ุงูุฅุตุงุจุฉ</th>
                <th>ุณุจุจ ุงูุฅุตุงุจุฉ</th>
                <th>ุงูุฅุฌุฑุงุก</th>
                <th>ุงูุณูุงูุฉ</th>
                <th>ุงูุทุจูุจ</th>
                <th>ุงูููุชุฑูู</th>
                <th>ุงููุดุฑู</th>
                <th>ููุงุญุธุงุช</th>
                <th>ุชุนุฏูู</th>
                <th>๐๏ธ</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let i of injuries; let idx = index">
                <td>{{ idx + 1 }}</td>
                <td><input [(ngModel)]="i.date" class="form-control form-control-sm text-center" /></td>
                <td><input [(ngModel)]="i.day" class="form-control form-control-sm text-center" readonly /></td>
                <td><input [(ngModel)]="i.time" class="form-control form-control-sm text-center" /></td>
                <td><input [(ngModel)]="i.location" class="form-control form-control-sm text-center" /></td>
                <td><input [(ngModel)]="i.memberName" class="form-control form-control-sm text-center" /></td>
                <td><input [(ngModel)]="i.membershipNo" class="form-control form-control-sm text-center" /></td>
                <td><input [(ngModel)]="i.injuryType" class="form-control form-control-sm text-center" /></td>
                <td><input [(ngModel)]="i.cause" class="form-control form-control-sm text-center" /></td>
                <td><input [(ngModel)]="i.action" class="form-control form-control-sm text-center" /></td>
                <td><input [(ngModel)]="i.safetyOfficer" class="form-control form-control-sm text-center" /></td>
                <td><input [(ngModel)]="i.medic" class="form-control form-control-sm text-center" /></td>
                <td><input [(ngModel)]="i.control" class="form-control form-control-sm text-center" /></td>
                <td><input [(ngModel)]="i.supervisor" class="form-control form-control-sm text-center" /></td>
                <td><input [(ngModel)]="i.notes" class="form-control form-control-sm text-center" /></td>
                <td><button class="btn btn-sm btn-success" (click)="updateInjury(i)">๐พ</button></td>
                <button class="btn btn-sm btn-danger" (click)="i.id && deleteInjury(i.id)">๐๏ธ</button>

            </tr>
        </tbody>
    </table>


    <!-- ุฌุฏูู ุงูุฅุญุตุงุฆูุงุช -->
    <div class="d-flex justify-content-center mt-5">
        <div class="card shadow-lg bg-dark text-light w-50 border-warning">
            <div class="card-body">
                <h4 class="text-center mb-4 fw-bold" style="color: #FFD700;">๐ ุฅุญุตุงุฆูุงุช ูุฎุงููุงุช ุงููุญูุงุช</h4>

                <div class="table-responsive">
                    <table class="table table-bordered text-center align-middle custom-table table-striped table-dark"
                        dir="rtl">
                        <thead class="table-warning text-dark">
                            <tr>
                                <th>ุงูููุน</th>
                                <th>ุงูุนุฏุฏ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ุฅุฌูุงูู ุงูุฐูุงุจ ุฅูู ุงูุนูุงุฏุฉ (ุฅุตุงุจุงุช ุฎูููุฉ)</td>
                                <td>{{ statistics.toClinic }}</td>
                            </tr>
                            <tr>
                                <td>ุฅุฌูุงูู ุงูุฐูุงุจ ุฅูู ุงูุนูุงุฏุฉ ูุงูุชูุฌูู ูููุณุชุดูู (ุฅุตุงุจุงุช ุญุฑุฌุฉ)</td>
                                <td>{{ statistics.toHospital }}</td>
                            </tr>
                            <tr>
                                <td>ุฅุฌูุงูู ุงุญุถุงุฑ ุงููุณุนู ููุท (ุฅุตุงุจุงุช ุฎูููุฉ)</td>
                                <td>{{ statistics.medicOnly }}</td>
                            </tr>
                            <tr>
                                <td>ุฅุฌูุงูู ุฑูุถ ุงุญุถุงุฑ ุงููุณุนู ูุชู ุงูุงุทูุฆูุงู ุนููู</td>
                                <td>{{ statistics.refused }}</td>
                            </tr>
                            <tr>
                                <td>ุฅุฌูุงูู ุงุญุถุงุฑ ุงููุณุนู ุซู ุงูุฐูุงุจ ููุนูุงุฏุฉ (ุฅุตุงุจุงุช ุญุฑุฌุฉ)</td>
                                <td>{{ statistics.medicThenClinic }}</td>
                            </tr>
                            <tr class="fw-bold text-warning">
                                <td>ุงูุฅุฌูุงูู ุงูุนุงู</td>
                                <td>{{ statistics.total }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>


    <div class="text-center my-4">
        <button class="btn btn-outline-light" (click)="exportToExcel()">๐ฅ ุชุตุฏูุฑ Excel</button>
    </div>

</div>